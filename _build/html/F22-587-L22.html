
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Lecture 22 &#8212; CEN 587 Fall 2022</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Recitations" href="Recitations.html" />
    <link rel="prev" title="&lt;no title&gt;" href="F22-587-L21.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/JQB.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CEN 587 Fall 2022</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to CEN 587!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="Lectures.html">
   Lectures
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L01.html">
     Lecture 01: Introduction and Stoichiometry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L02.html">
     Lecture 02: Extent and Conversion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L03.html">
     Lecture 03: Solving problems with numerical methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L04.html">
     Lecture 04
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L05.html">
     Lecture 05
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L06.html">
     Lecture 06
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L07.html">
     Lecture 07: Ammonia Equilibrium - Part 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L08.html">
     Lecture 08: Multi-reaction equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L09.html">
     Lecture 09: Chemical and Phase equilibria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L10.html">
     Lecture 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L11.html">
     Lecture 11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L12.html">
     Lecture 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L13.html">
     Lecture 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L14.html">
     Lecture 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L15.html">
     Lecture 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L16.html">
     Lecture 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L17.html">
     Lecture 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L18.html">
     Lecture 18
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L19.html">
     Lecture 19
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-L20.html">
     Lecture 20
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Lecture 22
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Recitations.html">
   Recitations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-R01-Solution.html">
     Recitation 01: Jupyter and Python Fundamentals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-R02-Solution.html">
     Recitation 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="F22-587-R03-Solution.html">
     Recitation 03
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/jqbond/2022CEN587/main?urlpath=tree/docs/F22-587-L22.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/jqbond/2022CEN587"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/jqbond/2022CEN587/issues/new?title=Issue%20on%20page%20%2FF22-587-L22.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/F22-587-L22.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-01">
   Example Problem 01
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-01">
     Solution to Example Problem 01
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-02">
   Example Problem 02
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-02">
     Solution to Example Problem 02
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#alternate-solution-to-example-problem-02">
     Alternate Solution to Example Problem 02
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#obtaining-mole-fractions-as-a-function-of-cstr-volume">
     Obtaining Mole Fractions as a function of CSTR Volume
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Lecture 22</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-01">
   Example Problem 01
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-01">
     Solution to Example Problem 01
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-problem-02">
   Example Problem 02
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-to-example-problem-02">
     Solution to Example Problem 02
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#alternate-solution-to-example-problem-02">
     Alternate Solution to Example Problem 02
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#obtaining-mole-fractions-as-a-function-of-cstr-volume">
     Obtaining Mole Fractions as a function of CSTR Volume
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-22">
<h1>Lecture 22<a class="headerlink" href="#lecture-22" title="Permalink to this headline">#</a></h1>
<p>This lecture introduces reactor design for systems involving multiple reactions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
<section id="example-problem-01">
<h2>Example Problem 01<a class="headerlink" href="#example-problem-01" title="Permalink to this headline">#</a></h2>
<p><strong>Rawlings, Example 4.5</strong>:</p>
<p>You are carrying out Benzene Pyrolysis in a Plug Flow Reactor operating at 1033K and 1.0 atm.  The two reactions occurring in this system are benzene coupling to form diphenyl and hydrogen followed by a secondary reaction between benzene and diphenyl to form triphenyl and hydrogen:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
&amp;2B \longleftrightarrow D + H_2\\
&amp;B + D \longleftrightarrow T + H_2
\end{align*}\]</div>
<p>Both reactions are reversible and <em><strong>follow elementary rate laws</strong></em>.  Rate constants and equilibrium concentration ratios (<span class="math notranslate nohighlight">\(K_C\)</span>) are given below.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
&amp;k_1 = 7.0 \ \times 10^5 \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{h}^{-1}\\
&amp;k_2 = 4.0 \ \times 10^5 \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{h}^{-1}\\
&amp;K_{C_1} = 0.31\\
&amp;K_{C_2} = 0.48
\end{align*}\]</div>
<p>If pure benzene is fed into the reactor at 60,000 moles per hour, find the PFR volume required to achieve 50% conversion of Benzene.  Also, plot the mole fraction of each species as a function of PFR volume.</p>
<p><strong>Answer</strong>: 403.3 L</p>
<section id="solution-to-example-problem-01">
<h3>Solution to Example Problem 01<a class="headerlink" href="#solution-to-example-problem-01" title="Permalink to this headline">#</a></h3>
<p>Even though there are multiple reactions, we approach this problem the same way as usual: we write a material balance on Benzene.</p>
<div class="math notranslate nohighlight">
\[\frac{dF_B}{dV} = R_B\]</div>
<p>We generally know that <span class="math notranslate nohighlight">\(R_B\)</span> is going to be a complex function of concentrations of all of the species present in this system.  That means we can’t solve the above balance on Benzene without also solving balances on Diphenyl, Hydrogen, and Triphenyl <em>at the same time</em>, i.e., we have to solve the coupled system of differential equations below:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f12f59bd-a6b4-4098-82c8-69e88895450b">
<span class="eqno">(107)<a class="headerlink" href="#equation-f12f59bd-a6b4-4098-82c8-69e88895450b" title="Permalink to this equation">#</a></span>\[\begin{align}
    \frac{dF_B}{dV} &amp;= R_B \\
    \frac{dF_D}{dV} &amp;= R_D \\
    \frac{dF_H}{dV} &amp;= R_H \\
    \frac{dF_T}{dV} &amp;= R_T \\
\end{align}\]</div>
<p>So, we’ve got 4 differential equations that tell us how 4 dependent variables (<span class="math notranslate nohighlight">\(F_B\)</span>, <span class="math notranslate nohighlight">\(F_D\)</span>, <span class="math notranslate nohighlight">\(F_H\)</span>, <span class="math notranslate nohighlight">\(F_T\)</span>) change as a function of the one independent variable, V.  We can solve this system <em>if</em> we can define everything on the right hand sides of the above equations (<span class="math notranslate nohighlight">\(R_B\)</span>, <span class="math notranslate nohighlight">\(R_D\)</span>, <span class="math notranslate nohighlight">\(R_H\)</span>, and <span class="math notranslate nohighlight">\(R_T\)</span>) in terms of <span class="math notranslate nohighlight">\(F_B\)</span>, <span class="math notranslate nohighlight">\(F_D\)</span>, <span class="math notranslate nohighlight">\(F_H\)</span>, <span class="math notranslate nohighlight">\(F_T\)</span>, and/or <span class="math notranslate nohighlight">\(V\)</span>.</p>
<p>We know how to do this!!</p>
<p>Generally:</p>
<div class="math notranslate nohighlight">
\[R_j = \sum_i \nu_{i,j} r_i\]</div>
<p>So:</p>
<div class="amsmath math notranslate nohighlight" id="equation-fb3d5a08-631b-4a92-90b2-8da055acb765">
<span class="eqno">(108)<a class="headerlink" href="#equation-fb3d5a08-631b-4a92-90b2-8da055acb765" title="Permalink to this equation">#</a></span>\[\begin{align}
    R_B &amp;= -2r1 - r2 \\
    R_D &amp;=  r1 - r2 \\
    R_H &amp;=  r2 + r2 \\
    R_T &amp;=  r2 \\
\end{align}\]</div>
<p>We next define reaction rates:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d85811c4-5c26-42c9-899b-712307e4e3a3">
<span class="eqno">(109)<a class="headerlink" href="#equation-d85811c4-5c26-42c9-899b-712307e4e3a3" title="Permalink to this equation">#</a></span>\[\begin{align}
    r_1 &amp;= k_{1,f}C_B^2 - k_{1,r}C_HC_D \\
    r_2 &amp;= k_{2,f}C_BC_D - k_{2,r}C_HC_T \\
\end{align}\]</div>
<p>We define concentrations in terms of molar flowrates:</p>
<div class="math notranslate nohighlight">
\[F_j = \frac{F_j}{Q}\]</div>
<p>Which throws a volumetric flowrate, Q, into the mix.  Fortunately, this is a gas phase reaction at low pressure, so we know we can define Q in terms of the total molar flowrate:</p>
<div class="math notranslate nohighlight">
\[Q = \frac{F_{tot}RT}{P}\]</div>
<p>Where</p>
<div class="math notranslate nohighlight">
\[F_{tot} = \sum_j F_j\]</div>
<p>With that, we’ve defined out system of ODES fully as a function of molar flowrates and reactor volume.  We can solve this numerically using solve_ivp.  See below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MR01</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
    
    <span class="c1">#Dependent variables are all in var</span>
    <span class="n">FB</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">FD</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">FH</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">FT</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    
    <span class="c1">#Constants from problem statement</span>
    <span class="n">T</span>   <span class="o">=</span> <span class="mi">1033</span>    <span class="c1">#K</span>
    <span class="n">P</span>   <span class="o">=</span> <span class="mf">1.0</span>     <span class="c1">#atm</span>
    <span class="n">R</span>   <span class="o">=</span> <span class="mf">0.08206</span> <span class="c1">#L*atm/mol/K</span>
    <span class="n">k1f</span> <span class="o">=</span> <span class="mf">7.0e5</span>   <span class="c1">#L/mol/h</span>
    <span class="n">k2f</span> <span class="o">=</span> <span class="mf">4.0e5</span>   <span class="c1">#L/mol/h</span>
    <span class="n">KC1</span> <span class="o">=</span> <span class="mf">0.31</span>
    <span class="n">KC2</span> <span class="o">=</span> <span class="mf">0.48</span>
    <span class="n">k1r</span> <span class="o">=</span> <span class="n">k1f</span><span class="o">/</span><span class="n">KC1</span> <span class="c1">#L/mol/h</span>
    <span class="n">k2r</span> <span class="o">=</span> <span class="n">k2f</span><span class="o">/</span><span class="n">KC2</span> <span class="c1">#L/mol/h=</span>
    
    <span class="c1">#total molar flowrate, function of individual molar flowrates</span>
    <span class="n">FTOT</span> <span class="o">=</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FD</span> <span class="o">+</span> <span class="n">FH</span> <span class="o">+</span> <span class="n">FT</span>
    
    <span class="c1">#volumetric flowrate</span>
    <span class="n">Q</span>    <span class="o">=</span> <span class="n">FTOT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>
    
    <span class="c1">#Define concentrations</span>
    <span class="n">CB</span>   <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CD</span>   <span class="o">=</span> <span class="n">FD</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CH</span>   <span class="o">=</span> <span class="n">FH</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CT</span>   <span class="o">=</span> <span class="n">FT</span><span class="o">/</span><span class="n">Q</span>
    
    <span class="c1">#now that we have concentrations, we define reaction rates</span>
    <span class="n">r1</span>   <span class="o">=</span> <span class="n">k1f</span><span class="o">*</span><span class="n">CB</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">k1r</span><span class="o">*</span><span class="n">CD</span><span class="o">*</span><span class="n">CH</span>
    <span class="n">r2</span>   <span class="o">=</span> <span class="n">k2f</span><span class="o">*</span><span class="n">CB</span><span class="o">*</span><span class="n">CD</span> <span class="o">-</span> <span class="n">k2r</span><span class="o">*</span><span class="n">CT</span><span class="o">*</span><span class="n">CH</span>
    
    <span class="c1">#With reaction rates, you can define production rates</span>
    <span class="n">RB</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RD</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RH</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span>
    <span class="n">RT</span>   <span class="o">=</span>         <span class="n">r2</span>
    
    <span class="c1">#For a PFR, dFj/dV = Rj, so these are our derivatives of FB, FD, FH, FT</span>
    <span class="n">D1</span>   <span class="o">=</span> <span class="n">RB</span>
    <span class="n">D2</span>   <span class="o">=</span> <span class="n">RD</span>
    <span class="n">D3</span>   <span class="o">=</span> <span class="n">RH</span>
    <span class="n">D4</span>   <span class="o">=</span> <span class="n">RT</span>
    
    <span class="c1">#return derivatives of each dependent variable w.r.t. volume</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">,</span> <span class="n">D3</span><span class="p">,</span> <span class="n">D4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#This cell solves the ODE system (an initial value problem) using solve_ivp</span>
<span class="n">FBf</span>     <span class="o">=</span> <span class="mi">60000</span> <span class="c1">#mol/h</span>
<span class="n">FDf</span>     <span class="o">=</span> <span class="mi">0</span>
<span class="n">FHf</span>     <span class="o">=</span> <span class="mi">0</span>
<span class="n">FTf</span>     <span class="o">=</span> <span class="mi">0</span>

<span class="c1">#Solve the problem</span>
<span class="n">vspan</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">var0</span>    <span class="o">=</span> <span class="p">[</span><span class="n">FBf</span><span class="p">,</span> <span class="n">FDf</span><span class="p">,</span> <span class="n">FHf</span><span class="p">,</span> <span class="n">FTf</span><span class="p">]</span>
<span class="n">solMR01</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">MR01</span><span class="p">,</span> <span class="n">vspan</span><span class="p">,</span> <span class="n">var0</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-12</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-12</span><span class="p">)</span>

<span class="c1">#Extract data from the solution structure.</span>
<span class="n">Vout</span>    <span class="o">=</span> <span class="n">solMR01</span><span class="o">.</span><span class="n">t</span>
<span class="n">FBout</span>   <span class="o">=</span> <span class="n">solMR01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#Calculate conversion</span>
<span class="n">XBout</span>   <span class="o">=</span> <span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FBout</span><span class="p">)</span><span class="o">/</span><span class="n">FBf</span>

<span class="c1">#Plot conversion vs. reactor volume.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">XBout</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">vspan</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">vspan</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Benzene Conversion&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#Create an interpolating polynomial f(XB) = V</span>
<span class="n">itp01</span>   <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">XBout</span><span class="p">,</span> <span class="n">Vout</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The Volume required to achive 50% Benzene conversion is </span><span class="si">{</span><span class="n">itp01</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="si">:</span><span class="s1">3.1f</span><span class="si">}</span><span class="s1">L&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/F22-587-L22_5_0.png" src="_images/F22-587-L22_5_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Volume required to achive 50% Benzene conversion is 403.3L
</pre></div>
</div>
</div>
</div>
<p>Now we extract all of the molar flowrates so we can calculate mole fractions as a function of reactor volume.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Molar flowrates as a function of volume.</span>
<span class="n">FBout</span>   <span class="o">=</span> <span class="n">solMR01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">FDout</span>   <span class="o">=</span> <span class="n">solMR01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">FHout</span>   <span class="o">=</span> <span class="n">solMR01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">FTout</span>   <span class="o">=</span> <span class="n">solMR01</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="c1">#Sum things up to get the total molar flowrate as a function of volume.</span>
<span class="n">FTot_o</span>  <span class="o">=</span> <span class="n">FBout</span> <span class="o">+</span> <span class="n">FDout</span> <span class="o">+</span> <span class="n">FHout</span> <span class="o">+</span> <span class="n">FTout</span>

<span class="c1">#Calculate mole fractions as a function of volume.</span>
<span class="n">yBout</span>   <span class="o">=</span> <span class="n">FBout</span><span class="o">/</span><span class="n">FTot_o</span>
<span class="n">yDout</span>   <span class="o">=</span> <span class="n">FDout</span><span class="o">/</span><span class="n">FTot_o</span>
<span class="n">yHout</span>   <span class="o">=</span> <span class="n">FHout</span><span class="o">/</span><span class="n">FTot_o</span>
<span class="n">yTout</span>   <span class="o">=</span> <span class="n">FTout</span><span class="o">/</span><span class="n">FTot_o</span>

<span class="c1">#Plot mole fractions vs. volume</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">yBout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yB&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">yDout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">yHout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yH&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vout</span><span class="p">,</span> <span class="n">yTout</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yT&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">vspan</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mole fraction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/F22-587-L22_7_0.png" src="_images/F22-587-L22_7_0.png" />
</div>
</div>
</section>
</section>
<section id="example-problem-02">
<h2>Example Problem 02<a class="headerlink" href="#example-problem-02" title="Permalink to this headline">#</a></h2>
<p><strong>Rawlings, Example 4.5 in a CSTR</strong>:</p>
<p>You are carrying out Benzene Pyrolysis in a CSTR operating at 1033K and 1.0 atm.  The two reactions occurring in this system are benzene coupling to form diphenyl and hydrogen followed by a secondary reaction between benzene and diphenyl to form triphenyl and hydrogen:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
&amp;2B \longleftrightarrow D + H_2\\
&amp;B + D \longleftrightarrow T + H_2
\end{align*}\]</div>
<p>Both reactions are reversible and follow elementary rate laws.  Rate constants and equilibrium concentration ratios (<span class="math notranslate nohighlight">\(K_C\)</span>) are given below.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
&amp;k_1 = 7.0 \ \times 10^5 \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{h}^{-1}\\
&amp;k_2 = 4.0 \ \times 10^5 \ \textrm{L} \ \textrm{mol}^{-1} \ \textrm{h}^{-1}\\
&amp;K_{C_1} = 0.31\\
&amp;K_{C_2} = 0.48
\end{align*}\]</div>
<p>If pure benzene is fed into the reactor at 60,000 moles per hour, find the CSTR volume required to achieve 50% conversion of Benzene.  Also, plot the mole fraction of each species as a function of CSTR volume.</p>
<p><strong>Answer</strong>: 1315.6 L; see graphs for mole fraction plots</p>
<section id="solution-to-example-problem-02">
<h3>Solution to Example Problem 02<a class="headerlink" href="#solution-to-example-problem-02" title="Permalink to this headline">#</a></h3>
<p>If we consider a material balance on Benzene in a CSTR at steady state:</p>
<div class="math notranslate nohighlight">
\[0 = F_{B,f} - F_B + R_BV\]</div>
<p>I can see that the term <span class="math notranslate nohighlight">\(R_B\)</span> actually will depend on the concentrations of diphenyl, triphenyl, and hydrogen (see the PFR discussion above).  So I won’t be able to solve this equation by itself.  I’ll need to somehow determine the concentrations of all species…</p>
<p>The easiest way to do this is to recognize that we can write a single, independent balance for each component:</p>
<div class="amsmath math notranslate nohighlight" id="equation-36a17671-920c-4453-910a-24387b26afbd">
<span class="eqno">(110)<a class="headerlink" href="#equation-36a17671-920c-4453-910a-24387b26afbd" title="Permalink to this equation">#</a></span>\[\begin{align}
    0 = F_{B,f} - F_B + R_BV \\
    0 = F_{D,f} - F_D + R_DV \\
    0 = F_{H,f} - F_H + R_HV \\
    0 = F_{T,f} - F_T + R_TV \\
\end{align}\]</div>
<p>The way I view this is that I have four equations written in terms of five unknowns (<span class="math notranslate nohighlight">\(F_B\)</span>, <span class="math notranslate nohighlight">\(F_D\)</span>, <span class="math notranslate nohighlight">\(F_H\)</span>, <span class="math notranslate nohighlight">\(F_T\)</span>, and <span class="math notranslate nohighlight">\(V\)</span>).  I say this because although I don’t “know” the production rates for each species, <span class="math notranslate nohighlight">\(R_j\)</span>, I can express all of those production rates in terms of species flow rates.</p>
<p>I need to do two things.  First, I need to add another equation to this system since I have an additional unknown (Volume).  I’ll do that from the conversion specification.</p>
<div class="amsmath math notranslate nohighlight" id="equation-346a87f3-2fe4-4152-83dd-5c82d35c4271">
<span class="eqno">(111)<a class="headerlink" href="#equation-346a87f3-2fe4-4152-83dd-5c82d35c4271" title="Permalink to this equation">#</a></span>\[\begin{align}
    0 &amp;= F_{B,f} - F_B + R_BV \\
    0 &amp;= F_{D,f} - F_D + R_DV \\
    0 &amp;= F_{H,f} - F_H + R_HV \\
    0 &amp;= F_{T,f} - F_T + R_TV \\
    0 &amp;= X_B - 0.5 \\
\end{align}\]</div>
<p>Now, I just have to make sure everything on the right hand side of those equations is expressed as functions of my five unknowns (<span class="math notranslate nohighlight">\(F_B\)</span>, <span class="math notranslate nohighlight">\(F_D\)</span>, <span class="math notranslate nohighlight">\(F_H\)</span>, <span class="math notranslate nohighlight">\(F_T\)</span>, and <span class="math notranslate nohighlight">\(V\)</span>).  We do this pretty much the same was as we do in the PFR case.  Starting with species production rates:</p>
<div class="math notranslate nohighlight">
\[R_j = \sum_i \nu_{i,j} r_i\]</div>
<p>So:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f8a788d9-abd6-44af-80e7-31ad31714be9">
<span class="eqno">(112)<a class="headerlink" href="#equation-f8a788d9-abd6-44af-80e7-31ad31714be9" title="Permalink to this equation">#</a></span>\[\begin{align}
    R_B &amp;= -2r1 - r2 \\
    R_D &amp;=  r1 - r2 \\
    R_H &amp;=  r2 + r2 \\
    R_T &amp;=  r2 \\
\end{align}\]</div>
<p>We next define reaction rates:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f598d053-9793-4719-b3c1-d941616dfab7">
<span class="eqno">(113)<a class="headerlink" href="#equation-f598d053-9793-4719-b3c1-d941616dfab7" title="Permalink to this equation">#</a></span>\[\begin{align}
    r_1 &amp;= k_{1,f}C_B^2 - k_{1,r}C_HC_D \\
    r_2 &amp;= k_{2,f}C_BC_D - k_{2,r}C_HC_T \\
\end{align}\]</div>
<p>We define concentrations in terms of molar flowrates:</p>
<div class="math notranslate nohighlight">
\[F_j = \frac{F_j}{Q}\]</div>
<p>Which throws a volumetric flowrate, Q, into the mix.  Fortunately, this is a gas phase reaction at low pressure, so we know we can define Q in terms of the total molar flowrate:</p>
<div class="math notranslate nohighlight">
\[Q = \frac{F_{tot}RT}{P}\]</div>
<p>Where</p>
<div class="math notranslate nohighlight">
\[F_{tot} = \sum_j F_j\]</div>
<p>We set this up below for solution with opt.root–five equations and five unknowns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MR02</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
    
    <span class="c1">#unknowns in the array var</span>
    <span class="n">FB</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">FD</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">FH</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">FT</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">V</span>  <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    
    <span class="c1">#Parameters from problem statement</span>
    <span class="n">T</span>   <span class="o">=</span> <span class="mi">1033</span>    <span class="c1">#K</span>
    <span class="n">P</span>   <span class="o">=</span> <span class="mf">1.0</span>     <span class="c1">#atm</span>
    <span class="n">R</span>   <span class="o">=</span> <span class="mf">0.08206</span> <span class="c1">#L*atm/mol/K</span>
    <span class="n">k1f</span> <span class="o">=</span> <span class="mf">7.0e5</span>   <span class="c1">#L/mol/h</span>
    <span class="n">k2f</span> <span class="o">=</span> <span class="mf">4.0e5</span>   <span class="c1">#L/mol/h</span>
    <span class="n">KC1</span> <span class="o">=</span> <span class="mf">0.31</span>
    <span class="n">KC2</span> <span class="o">=</span> <span class="mf">0.48</span>
    <span class="n">k1r</span> <span class="o">=</span> <span class="n">k1f</span><span class="o">/</span><span class="n">KC1</span> <span class="c1">#L/mol/h</span>
    <span class="n">k2r</span> <span class="o">=</span> <span class="n">k2f</span><span class="o">/</span><span class="n">KC2</span> <span class="c1">#L/mol/h</span>
    <span class="n">FBf</span> <span class="o">=</span> <span class="mi">60000</span>   <span class="c1">#mol/h</span>
    <span class="n">FDf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">FHf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">FTf</span> <span class="o">=</span> <span class="mi">0</span>
                
    <span class="c1">#Total molar flowrate</span>
    <span class="n">FTOT</span> <span class="o">=</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FD</span> <span class="o">+</span> <span class="n">FH</span> <span class="o">+</span> <span class="n">FT</span>
    
    <span class="c1">#Volumetric flowrate</span>
    <span class="n">Q</span>    <span class="o">=</span> <span class="n">FTOT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>
    
    <span class="c1">#Define species concentrations</span>
    <span class="n">CB</span>   <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CD</span>   <span class="o">=</span> <span class="n">FD</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CH</span>   <span class="o">=</span> <span class="n">FH</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CT</span>   <span class="o">=</span> <span class="n">FT</span><span class="o">/</span><span class="n">Q</span>
    
    <span class="c1">#Define reaction rates</span>
    <span class="n">r1</span>   <span class="o">=</span> <span class="n">k1f</span><span class="o">*</span><span class="n">CB</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">k1r</span><span class="o">*</span><span class="n">CD</span><span class="o">*</span><span class="n">CH</span>
    <span class="n">r2</span>   <span class="o">=</span> <span class="n">k2f</span><span class="o">*</span><span class="n">CB</span><span class="o">*</span><span class="n">CD</span> <span class="o">-</span> <span class="n">k2r</span><span class="o">*</span><span class="n">CT</span><span class="o">*</span><span class="n">CH</span>
    
    <span class="c1">#Define species production rates</span>
    <span class="n">RB</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RD</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RH</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span>
    <span class="n">RT</span>   <span class="o">=</span>         <span class="n">r2</span>
    
    <span class="c1">#Define fractional conversion</span>
    <span class="n">XB</span>   <span class="o">=</span> <span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FB</span><span class="p">)</span><span class="o">/</span><span class="n">FBf</span>
    
    <span class="c1">#Write the five equations to be solved.</span>
    <span class="n">F1</span>   <span class="o">=</span> <span class="n">FBf</span> <span class="o">-</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">RB</span><span class="o">*</span><span class="n">V</span>
    <span class="n">F2</span>   <span class="o">=</span> <span class="n">FDf</span> <span class="o">-</span> <span class="n">FD</span> <span class="o">+</span> <span class="n">RD</span><span class="o">*</span><span class="n">V</span>
    <span class="n">F3</span>   <span class="o">=</span> <span class="n">FHf</span> <span class="o">-</span> <span class="n">FH</span> <span class="o">+</span> <span class="n">RH</span><span class="o">*</span><span class="n">V</span>
    <span class="n">F4</span>   <span class="o">=</span> <span class="n">FTf</span> <span class="o">-</span> <span class="n">FT</span> <span class="o">+</span> <span class="n">RT</span><span class="o">*</span><span class="n">V</span>
    <span class="n">F5</span>   <span class="o">=</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">XB</span>

    <span class="c1">#Return the left hand side of each of the five constraint equations</span>
    <span class="c1">#When the problem is solved, these should all be zero.</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">,</span> <span class="n">F3</span><span class="p">,</span> <span class="n">F4</span><span class="p">,</span> <span class="n">F5</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Solve the system of equations using opt.root</span>

<span class="c1">#We need to provide initial guesses for each of our unknowns (FB, FD, FH, FT, V)</span>
<span class="n">var0</span>    <span class="o">=</span> <span class="p">(</span><span class="n">FBf</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">FBf</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">FBf</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">FBf</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">solMR02</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">MR02</span><span class="p">,</span> <span class="n">var0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solMR02</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>

<span class="c1">#Where volume is given by</span>
<span class="n">solMR02</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[30000.          9769.00421991 16743.66526003  3487.33052006
  1315.62036749]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1315.620367487792
</pre></div>
</div>
</div>
</div>
</section>
<section id="alternate-solution-to-example-problem-02">
<h3>Alternate Solution to Example Problem 02<a class="headerlink" href="#alternate-solution-to-example-problem-02" title="Permalink to this headline">#</a></h3>
<p>Fundamentally, there is nothing wrong with the approach above, where we wrote a material balance on each species to solve the problem.</p>
<p>Sometimes, when solving algebraic problems with numerical methods (like opt.root), it is very difficult for the solver to converge.  This is because a) solving algebraic equations numerically is challenging; b) solving the system gets more challenging when we write more equations; and c) we need to provide a good initial guess as to <em>what the correct solution is</em>.  Otherwise, the problem will not usually converge.</p>
<p>It can be useful to reduce the number of equations and unknowns that we’re tying to solve.  We can do this by taking an alternate approach.  Specifically, instead of describing the system in terms of molar flowrates for all species (and volume), which gives us five unkowns, we can decide to instead express the system in terms of one extent of reaction for each reaction occuring and the system volume.  If we do this, we get to write one extent per chemical reaction, and we get to write one material balance for each reaction.</p>
<p>So, above we wrote the following five equations:</p>
<div class="amsmath math notranslate nohighlight" id="equation-2d1f9e1b-1b70-4ac3-b1b2-e1a341f77eec">
<span class="eqno">(114)<a class="headerlink" href="#equation-2d1f9e1b-1b70-4ac3-b1b2-e1a341f77eec" title="Permalink to this equation">#</a></span>\[\begin{align}
    0 &amp;= F_{B,f} - F_B + R_BV \\
    0 &amp;= F_{D,f} - F_D + R_DV \\
    0 &amp;= F_{H,f} - F_H + R_HV \\
    0 &amp;= F_{T,f} - F_T + R_TV \\
    0 &amp;= X_B - 0.5 \\
\end{align}\]</div>
<p>And we are able to express all of the production rates in terms of molar flowrates.  Here, we’ll express each exit flowrate in terms of extents of reaction (as we would do in a mole table):</p>
<div class="amsmath math notranslate nohighlight" id="equation-cd15eb3c-bb4a-4a38-99c7-b3fc06843397">
<span class="eqno">(115)<a class="headerlink" href="#equation-cd15eb3c-bb4a-4a38-99c7-b3fc06843397" title="Permalink to this equation">#</a></span>\[\begin{align}
    F_B &amp;= F_{B,f} - 2\varepsilon_1 - \varepsilon_2 \\
    F_D &amp;= F_{D,f} + \varepsilon_1 - \varepsilon_2 \\
    F_H &amp;= F_{H,f} + \varepsilon_1 + \varepsilon_2 \\
    F_T &amp;= F_{T,f} + \varepsilon_2 \\
\end{align}\]</div>
<p>By doing this, we reduce the system to 3 unknowns (<span class="math notranslate nohighlight">\(\varepsilon_1\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_2\)</span>, and <span class="math notranslate nohighlight">\(V\)</span>).  Therefore, we only get to write 3 equations.  When we express the system in terms of extents, we get to write one balance per reaction instead of one balance per species.  I can arbitrarily pick two independent balance equations.  I will keep the specification that fractional conversion is 50% as my third equation.  That gives me:</p>
<div class="amsmath math notranslate nohighlight" id="equation-dd8029ce-a0fe-4616-a902-7de4287eac3b">
<span class="eqno">(116)<a class="headerlink" href="#equation-dd8029ce-a0fe-4616-a902-7de4287eac3b" title="Permalink to this equation">#</a></span>\[\begin{align}
    0 &amp;= F_{B,f} - F_B + R_BV \\
    0 &amp;= F_{D,f} - F_D + R_DV \\
    0 &amp;= X_B - 0.5 \\
\end{align}\]</div>
<p>Where, in this case, I just have to make sure to express everything on the right hand side of these equations in terms of (<span class="math notranslate nohighlight">\(\varepsilon_1\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_2\)</span>, and <span class="math notranslate nohighlight">\(V\)</span>). We do this as usual:</p>
<div class="math notranslate nohighlight">
\[R_j = \sum_i \nu_{i,j} r_i\]</div>
<p>So:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e943f2ce-e106-4b9f-b97f-324e82763dfd">
<span class="eqno">(117)<a class="headerlink" href="#equation-e943f2ce-e106-4b9f-b97f-324e82763dfd" title="Permalink to this equation">#</a></span>\[\begin{align}
    R_B &amp;= -2r1 - r2 \\
    R_D &amp;=  r1 - r2 \\
    R_H &amp;=  r2 + r2 \\
    R_T &amp;=  r2 \\
\end{align}\]</div>
<p>We next define reaction rates:</p>
<div class="amsmath math notranslate nohighlight" id="equation-a788c3af-a2fc-4898-a259-20ead382799c">
<span class="eqno">(118)<a class="headerlink" href="#equation-a788c3af-a2fc-4898-a259-20ead382799c" title="Permalink to this equation">#</a></span>\[\begin{align}
    r_1 &amp;= k_{1,f}C_B^2 - k_{1,r}C_HC_D \\
    r_2 &amp;= k_{2,f}C_BC_D - k_{2,r}C_HC_T \\
\end{align}\]</div>
<p>We define concentrations in terms of molar flowrates:</p>
<div class="math notranslate nohighlight">
\[F_j = \frac{F_j}{Q}\]</div>
<p>Which throws a volumetric flowrate, Q, into the mix.  Fortunately, this is a gas phase reaction at low pressure, so we know we can define Q in terms of the total molar flowrate:</p>
<div class="math notranslate nohighlight">
\[Q = \frac{F_{tot}RT}{P}\]</div>
<p>Where</p>
<div class="math notranslate nohighlight">
\[F_{tot} = \sum_j F_j\]</div>
<p>If you go back and trace through all of these definitions, you’ll see that everything on the right hand side of our three equations is expressed in terms of either constants or our three unknowns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MR03</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
    <span class="c1">#Unknowns</span>
    <span class="n">e1</span>  <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">e2</span>  <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">V</span>   <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="c1">#Unknowns</span>
    <span class="n">T</span>   <span class="o">=</span> <span class="mi">1033</span>    <span class="c1">#K</span>
    <span class="n">P</span>   <span class="o">=</span> <span class="mf">1.0</span>     <span class="c1">#atm</span>
    <span class="n">R</span>   <span class="o">=</span> <span class="mf">0.08206</span> <span class="c1">#L*atm/mol/K</span>
    <span class="n">k1f</span> <span class="o">=</span> <span class="mf">7.0e5</span>   <span class="c1">#L/mol/h</span>
    <span class="n">k2f</span> <span class="o">=</span> <span class="mf">4.0e5</span>   <span class="c1">#L/mol/h</span>
    <span class="n">KC1</span> <span class="o">=</span> <span class="mf">0.31</span>
    <span class="n">KC2</span> <span class="o">=</span> <span class="mf">0.48</span>
    <span class="n">k1r</span> <span class="o">=</span> <span class="n">k1f</span><span class="o">/</span><span class="n">KC1</span> <span class="c1">#L/mol/h</span>
    <span class="n">k2r</span> <span class="o">=</span> <span class="n">k2f</span><span class="o">/</span><span class="n">KC2</span> <span class="c1">#L/mol/h</span>
    <span class="n">FBf</span> <span class="o">=</span> <span class="mi">60000</span>   <span class="c1">#mol/h</span>
    <span class="n">FDf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">FHf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">FTf</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="n">FB</span>   <span class="o">=</span> <span class="n">FBf</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">*</span><span class="n">e2</span>
    <span class="n">FD</span>   <span class="o">=</span> <span class="n">FDf</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">e1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">*</span><span class="n">e2</span>
    <span class="n">FH</span>   <span class="o">=</span> <span class="n">FHf</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">e1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">e2</span>
    <span class="n">FT</span>   <span class="o">=</span> <span class="n">FTf</span> <span class="o">+</span> <span class="mi">0</span><span class="o">*</span><span class="n">e1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">e2</span>
    
    <span class="n">FTOT</span> <span class="o">=</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FD</span> <span class="o">+</span> <span class="n">FH</span> <span class="o">+</span> <span class="n">FT</span>
    <span class="n">Q</span>    <span class="o">=</span> <span class="n">FTOT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>
    
    <span class="n">CB</span>   <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CD</span>   <span class="o">=</span> <span class="n">FD</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CH</span>   <span class="o">=</span> <span class="n">FH</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CT</span>   <span class="o">=</span> <span class="n">FT</span><span class="o">/</span><span class="n">Q</span>
    
    <span class="n">r1</span>   <span class="o">=</span> <span class="n">k1f</span><span class="o">*</span><span class="n">CB</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">k1r</span><span class="o">*</span><span class="n">CD</span><span class="o">*</span><span class="n">CH</span>
    <span class="n">r2</span>   <span class="o">=</span> <span class="n">k2f</span><span class="o">*</span><span class="n">CB</span><span class="o">*</span><span class="n">CD</span> <span class="o">-</span> <span class="n">k2r</span><span class="o">*</span><span class="n">CT</span><span class="o">*</span><span class="n">CH</span>
    
    <span class="n">RB</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RD</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RH</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span>
    <span class="n">RT</span>   <span class="o">=</span>         <span class="n">r2</span>
    
    <span class="n">XB</span>   <span class="o">=</span> <span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FB</span><span class="p">)</span><span class="o">/</span><span class="n">FBf</span>
    
    <span class="n">F1</span>   <span class="o">=</span> <span class="n">FBf</span> <span class="o">-</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">RB</span><span class="o">*</span><span class="n">V</span>
    <span class="n">F2</span>   <span class="o">=</span> <span class="n">FDf</span> <span class="o">-</span> <span class="n">FD</span> <span class="o">+</span> <span class="n">RD</span><span class="o">*</span><span class="n">V</span>
    <span class="n">F3</span>   <span class="o">=</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">XB</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">,</span> <span class="n">F3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Now we solve the system of 3 equations/3 unknowns</span>

<span class="n">var0</span>    <span class="o">=</span> <span class="p">(</span><span class="mi">20000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">solMR03</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">MR03</span><span class="p">,</span> <span class="n">var0</span><span class="p">)</span>
<span class="n">solMR03</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    fjac: array([[-8.41636059e-01,  5.40045132e-01,  2.51344552e-06],
       [-5.40045132e-01, -8.41636059e-01,  4.46730782e-06],
       [-4.52795422e-06, -2.40247333e-06, -1.00000000e+00]])
     fun: array([-6.31771400e-08,  8.97707650e-08, -1.11022302e-16])
 message: &#39;The solution converged.&#39;
    nfev: 17
     qtf: array([-2.40952836e-04,  9.79760003e-05, -1.67932875e-10])
       r: array([-1.32620072e+01, -1.28304668e+00,  2.52908371e+01, -3.00892595e+00,
        5.21408349e+00,  8.68600570e-05])
  status: 1
 success: True
       x: array([13256.33473996,  3487.33052008,  1315.62036749])
</pre></div>
</div>
</div>
</div>
</section>
<section id="obtaining-mole-fractions-as-a-function-of-cstr-volume">
<h3>Obtaining Mole Fractions as a function of CSTR Volume<a class="headerlink" href="#obtaining-mole-fractions-as-a-function-of-cstr-volume" title="Permalink to this headline">#</a></h3>
<p>As a final point, we still want to plot the mole fraction of products as a function of reactor volume.  For a CSTR, we solve one fractional conversion at one volume in the set of algebraic equations above.  If we want to solve for many volumes, we’ll have to solve the set of algebraic equations for every volume we’re interested in.  I do this below by passing a “current” volume into the system of equations, and solving it for many volumes using a for loop.  The key thing to note is that I will specify volume and solve for the two extents at that volume, so I’m down to two unknowns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MR04</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
    <span class="c1">#Unknowns</span>
    <span class="n">e1</span>  <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">e2</span>  <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1">#Parameters and constants from problem statement.</span>
    <span class="n">T</span>   <span class="o">=</span> <span class="mi">1033</span>    <span class="c1">#K</span>
    <span class="n">P</span>   <span class="o">=</span> <span class="mf">1.0</span>     <span class="c1">#atm</span>
    <span class="n">R</span>   <span class="o">=</span> <span class="mf">0.08206</span> <span class="c1">#L*atm/mol/K</span>
    <span class="n">k1f</span> <span class="o">=</span> <span class="mf">7.0e5</span>   <span class="c1">#L/mol/h</span>
    <span class="n">k2f</span> <span class="o">=</span> <span class="mf">4.0e5</span>   <span class="c1">#L/mol/h</span>
    <span class="n">KC1</span> <span class="o">=</span> <span class="mf">0.31</span>
    <span class="n">KC2</span> <span class="o">=</span> <span class="mf">0.48</span>
    <span class="n">k1r</span> <span class="o">=</span> <span class="n">k1f</span><span class="o">/</span><span class="n">KC1</span> <span class="c1">#L/mol/h</span>
    <span class="n">k2r</span> <span class="o">=</span> <span class="n">k2f</span><span class="o">/</span><span class="n">KC2</span> <span class="c1">#L/mol/h</span>
    <span class="n">FBf</span> <span class="o">=</span> <span class="mi">60000</span>   <span class="c1">#mol/h</span>
    <span class="n">FDf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">FHf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">FTf</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="n">FB</span>   <span class="o">=</span> <span class="n">FBf</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">*</span><span class="n">e2</span>
    <span class="n">FD</span>   <span class="o">=</span> <span class="n">FDf</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">e1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">*</span><span class="n">e2</span>
    <span class="n">FH</span>   <span class="o">=</span> <span class="n">FHf</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">e1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">e2</span>
    <span class="n">FT</span>   <span class="o">=</span> <span class="n">FTf</span> <span class="o">+</span> <span class="mi">0</span><span class="o">*</span><span class="n">e1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">e2</span>
    
    <span class="n">FTOT</span> <span class="o">=</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FD</span> <span class="o">+</span> <span class="n">FH</span> <span class="o">+</span> <span class="n">FT</span>
    <span class="n">Q</span>    <span class="o">=</span> <span class="n">FTOT</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span>
    
    <span class="n">CB</span>   <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CD</span>   <span class="o">=</span> <span class="n">FD</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CH</span>   <span class="o">=</span> <span class="n">FH</span><span class="o">/</span><span class="n">Q</span>
    <span class="n">CT</span>   <span class="o">=</span> <span class="n">FT</span><span class="o">/</span><span class="n">Q</span>
    
    <span class="n">r1</span>   <span class="o">=</span> <span class="n">k1f</span><span class="o">*</span><span class="n">CB</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">k1r</span><span class="o">*</span><span class="n">CD</span><span class="o">*</span><span class="n">CH</span>
    <span class="n">r2</span>   <span class="o">=</span> <span class="n">k2f</span><span class="o">*</span><span class="n">CB</span><span class="o">*</span><span class="n">CD</span> <span class="o">-</span> <span class="n">k2r</span><span class="o">*</span><span class="n">CT</span><span class="o">*</span><span class="n">CH</span>
    
    <span class="n">RB</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RD</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>
    <span class="n">RH</span>   <span class="o">=</span>    <span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span>
    <span class="n">RT</span>   <span class="o">=</span>         <span class="n">r2</span>
    
    <span class="n">XB</span>   <span class="o">=</span> <span class="p">(</span><span class="n">FBf</span> <span class="o">-</span> <span class="n">FB</span><span class="p">)</span><span class="o">/</span><span class="n">FBf</span>
    
    <span class="c1">#Constraint equations</span>
    <span class="n">F1</span>   <span class="o">=</span> <span class="n">FBf</span> <span class="o">-</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">RB</span><span class="o">*</span><span class="n">V</span>
    <span class="n">F2</span>   <span class="o">=</span> <span class="n">FDf</span> <span class="o">-</span> <span class="n">FD</span> <span class="o">+</span> <span class="n">RD</span><span class="o">*</span><span class="n">V</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>So, with the above function defined, I can pass it a value of volume, and I can solve for the two extents of reaction at that volume.  I do this by passing the volume as an extra parameter with a lambda function. See below where I solve the above for 1000L.  Although it looks complicated, this is effectively the same as writing:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>V = 1000
</pre></div>
</div>
<p>in the middle of my MR04 function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol</span>     <span class="o">=</span> <span class="mi">1000</span>
<span class="n">var0</span>    <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span> <span class="c1">#initial guess for solution of e1 and e2</span>
<span class="n">objtemp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">var</span><span class="p">:</span> <span class="n">MR04</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">vol</span><span class="p">)</span>
<span class="n">tempsol</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">objtemp</span><span class="p">,</span> <span class="n">var0</span><span class="p">)</span>
<span class="n">tempsol</span><span class="o">.</span><span class="n">x</span> <span class="c1">#This is the extent of reactions (e1 and e2) for V = 1000L</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([12836.64907302,  3104.40964972])
</pre></div>
</div>
</div>
</div>
<p>Well, if we can do that for one volume, we can do it for 100 volumes.  We’ll set up a loop for this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create a list of volumes we&#39;re interested in solving, we&#39;ll just go from 1 to 25000L</span>
<span class="c1">#We&#39;ll do this in 100 elements.  Basically, we&#39;re going to have to solve the above system for 100 different volumes.</span>
<span class="n">V</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">extent</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">V</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vol</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">V</span><span class="p">):</span> 
    <span class="n">obj02</span>   <span class="o">=</span> <span class="k">lambda</span> <span class="n">var</span><span class="p">:</span> <span class="n">MR04</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">vol</span><span class="p">)</span>
    <span class="n">var0</span>    <span class="o">=</span> <span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">solMR04</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">obj02</span><span class="p">,</span> <span class="n">var0</span><span class="p">)</span>
    <span class="n">extent</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>  <span class="o">=</span> <span class="n">solMR04</span><span class="o">.</span><span class="n">x</span>
<span class="n">extent</span>

<span class="n">FB</span> <span class="o">=</span> <span class="n">FBf</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">extent</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">*</span><span class="n">extent</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">FD</span> <span class="o">=</span> <span class="n">FDf</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">extent</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">*</span><span class="n">extent</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">FH</span> <span class="o">=</span> <span class="n">FHf</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">extent</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">extent</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">FT</span> <span class="o">=</span> <span class="n">FTf</span> <span class="o">+</span> <span class="mi">0</span><span class="o">*</span><span class="n">extent</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">extent</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">FTot</span> <span class="o">=</span> <span class="n">FB</span> <span class="o">+</span> <span class="n">FD</span> <span class="o">+</span> <span class="n">FH</span> <span class="o">+</span> <span class="n">FT</span>
<span class="n">yB</span>   <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">FTot</span>
<span class="n">yD</span>   <span class="o">=</span> <span class="n">FD</span><span class="o">/</span><span class="n">FTot</span>
<span class="n">yH</span>   <span class="o">=</span> <span class="n">FH</span><span class="o">/</span><span class="n">FTot</span>
<span class="n">yT</span>   <span class="o">=</span> <span class="n">FT</span><span class="o">/</span><span class="n">FTot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">yB</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yB&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">yD</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">yH</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yH&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">yT</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;yT&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">V</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (L)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mole fraction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/F22-587-L22_20_0.png" src="_images/F22-587-L22_20_0.png" />
</div>
</div>
<p>As a reminder of the significance of chemical equilibrium in these systems, we see that the composition stops changing after a certain reactor size.  At this point, we’ve reached equilibrium.  You can see this by comparing the value of the reaction quotient to the equilibrium constant.  The system is approaching equilibrium as the reaction reaches 15000L, and if we make the reactor much larger, the extra volume won’t be useful for increasing conversion since the system is basically equilibrated and no further conversion is possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span>   <span class="o">=</span> <span class="mi">1033</span>    <span class="c1">#K</span>
<span class="n">P</span>   <span class="o">=</span> <span class="mf">1.0</span>     <span class="c1">#atm</span>
<span class="n">R</span>   <span class="o">=</span> <span class="mf">0.08206</span> <span class="c1">#L*atm/mol/K</span>
<span class="n">CB</span> <span class="o">=</span> <span class="n">yB</span><span class="o">*</span><span class="n">P</span><span class="o">/</span><span class="n">R</span><span class="o">/</span><span class="n">T</span> <span class="c1">#This is the ideal gas law, believe it or not.</span>
<span class="n">CD</span> <span class="o">=</span> <span class="n">yD</span><span class="o">*</span><span class="n">P</span><span class="o">/</span><span class="n">R</span><span class="o">/</span><span class="n">T</span>
<span class="n">CH</span> <span class="o">=</span> <span class="n">yH</span><span class="o">*</span><span class="n">P</span><span class="o">/</span><span class="n">R</span><span class="o">/</span><span class="n">T</span>
<span class="n">CT</span> <span class="o">=</span> <span class="n">yT</span><span class="o">*</span><span class="n">P</span><span class="o">/</span><span class="n">R</span><span class="o">/</span><span class="n">T</span>

<span class="n">Q1</span> <span class="o">=</span> <span class="n">CD</span><span class="o">*</span><span class="n">CH</span><span class="o">/</span><span class="n">CB</span><span class="o">**</span><span class="mi">2</span> <span class="c1">#This is the right hand side of K_C = product(C_j^\nu_j) for rxn 1</span>
<span class="n">Q2</span> <span class="o">=</span> <span class="n">CT</span><span class="o">*</span><span class="n">CH</span><span class="o">/</span><span class="n">CD</span><span class="o">/</span><span class="n">CB</span> <span class="c1">#This is the right hand side of K_C = product(C_j^\nu_j) for rxn 2</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">Q1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Q1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">Q2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Q2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.31</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">V</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;K1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.48</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">V</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;K2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/F22-587-L22_22_0.png" src="_images/F22-587-L22_22_0.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="F22-587-L21.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">&lt;no title&gt;</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Recitations.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Recitations</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By JQB<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>